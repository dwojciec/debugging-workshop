apiVersion: 1.0.0
metadata:
  name: wksp-debugging
projects:
  - name: workshop
    source:
      location: 'https://github.com/mcouliba/debugging-workshop.git'
      type: git
      branch: "3.1"
components:
  - id: redhat/workshop-tools/3.1
    type: chePlugin
    alias: workshop-tools
commands:
  - name: 'Catalog - Route Traffic to Local'
    actions:
      - workdir: /projects/workshop/catalog-spring-boot
        type: exec
        command: >-
          echo "------ START ------";
          ike develop --deployment catalog-v1 --run 'mvn spring-boot:run' --port 9000:8080 --route header:ike-session-id=lab3;
          echo "------ END ------";
        component: workshop-tools
  - name: 'Inventory - Route Traffic to Local'
    actions:
      - workdir: /projects/workshop/inventory-quarkus
        type: exec
        command: >-
          echo "------ START ------";
          ike develop -d inventory-v1 -p 8080 -r 'mvn compile quarkus:dev' --route header:ike-session-id=lab4;
          echo "------ END ------";
        component: workshop-tools
  - name: 'Connect Local Java Debugger'
    actions:
      - type: vscode-launch
        referenceContent: |
          {
          "version": "0.2.0",
          "configurations": [
            {
              "type": "java",
              "name": "Debug (Attach) - Local",
              "request": "attach",
              "hostName": "localhost",
              "port": 5005
            }]
          }
